2025-03-08 08:31:57,553 - INFO - =============== Configurations ===============
2025-03-08 08:31:57,557 - INFO - DATA_MODE: offline
2025-03-08 08:31:57,584 - INFO - START_DATE: 2000-01-01
2025-03-08 08:31:57,586 - INFO - END_DATE: 2025-3-31
2025-03-08 08:31:57,591 - INFO - TICKERS: ['SPY', 'VOO', 'EFA', 'EEM', 'DBC', 'GLD', 'EDV', 'LTPZ', 'LOD', 'EMLC']
2025-03-08 08:31:57,694 - INFO - ASSET_ALLOCATION: {'VOO': 0.12, 'EFA': 0.12, 'EEM': 0.12, 'DBC': 0.07, 'GLD': 0.07, 'EDV': 0.18, 'LTPZ': 0.18, 'LOD': 0.07, 'EMLC': 0.07}
2025-03-08 08:31:57,715 - INFO - AGGRESSIVE_ALLOCATION: {'VOO': 0.12, 'EFA': 0.12, 'EEM': 0.12, 'DBC': 0.07, 'GLD': 0.07, 'EDV': 0.18, 'LTPZ': 0.18, 'LOD': 0.07, 'EMLC': 0.07}
2025-03-08 08:31:57,747 - INFO - MODERATE_ALLOCATION: {'VOO': 0.12, 'EFA': 0.12, 'EEM': 0.12, 'DBC': 0.07, 'GLD': 0.07, 'EDV': 0.18, 'LTPZ': 0.18, 'LOD': 0.07, 'EMLC': 0.07}
2025-03-08 08:31:57,748 - INFO - MID_DEFENSIVE_ALLOCATION: {'VOO': 0.12, 'EFA': 0.12, 'EEM': 0.12, 'DBC': 0.07, 'GLD': 0.07, 'EDV': 0.18, 'LTPZ': 0.18, 'LOD': 0.07, 'EMLC': 0.07}
2025-03-08 08:31:57,750 - INFO - DEFENSIVE_ALLOCATION: {'VOO': 0.12, 'EFA': 0.12, 'EEM': 0.12, 'DBC': 0.07, 'GLD': 0.07, 'EDV': 0.18, 'LTPZ': 0.18, 'LOD': 0.07, 'EMLC': 0.07}
2025-03-08 08:31:57,752 - INFO - TOUCHSTONE: SPY
2025-03-08 08:31:57,754 - INFO - MA_PERIODS: [21, 50, 150, 200]
2025-03-08 08:31:57,755 - INFO - WMA_PERIODS: [10, 30]
2025-03-08 08:31:57,757 - INFO - MA_TYPE: daily
2025-03-08 08:31:57,759 - INFO - INITIAL_CASH: 100000.0
2025-03-08 08:31:57,760 - INFO - COMMISSION: 0.001
2025-03-08 08:31:57,763 - INFO - CASH_BUFFER_PERCENT: 1.0
2025-03-08 08:31:57,765 - INFO - PROCESS_SELL_FIRST: True
2025-03-08 08:31:57,766 - INFO - RISK_FREE_RATE: 0.01
2025-03-08 08:31:57,768 - INFO - FRACTIONAL_SHARES: False
2025-03-08 08:31:57,770 - INFO - USE_MARKET_REGIME: False
2025-03-08 08:31:57,771 - INFO - REBALANCING_TERM: YEAR
2025-03-08 08:31:57,773 - INFO - LOG_LEVEL: INFO
2025-03-08 08:31:57,776 - INFO - ===============================================
2025-03-08 08:31:57,778 - INFO - Starting backtest...
2025-03-08 08:31:57,781 - INFO - Loading data feeds...
2025-03-08 08:31:57,783 - INFO - Loading data for SPY...
2025-03-08 08:31:57,787 - INFO - Downloading data for SPY from 2000-01-01 to 2025-3-31.
2025-03-08 08:31:59,863 - INFO - Saved RAW data for SPY to C:\Users\james\Projects\backtrader\data\SPY_raw.csv (6334 rows).
2025-03-08 08:31:59,864 - INFO - Loading data for VOO...
2025-03-08 08:31:59,866 - INFO - Downloading data for VOO from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:00,503 - INFO - Saved RAW data for VOO to C:\Users\james\Projects\backtrader\data\VOO_raw.csv (3646 rows).
2025-03-08 08:32:00,504 - INFO - Loading data for EFA...
2025-03-08 08:32:00,506 - INFO - Downloading data for EFA from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:01,170 - INFO - Saved RAW data for EFA to C:\Users\james\Projects\backtrader\data\EFA_raw.csv (5917 rows).
2025-03-08 08:32:01,171 - INFO - Loading data for EEM...
2025-03-08 08:32:01,173 - INFO - Downloading data for EEM from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:01,800 - INFO - Saved RAW data for EEM to C:\Users\james\Projects\backtrader\data\EEM_raw.csv (5511 rows).
2025-03-08 08:32:01,801 - INFO - Loading data for DBC...
2025-03-08 08:32:01,803 - INFO - Downloading data for DBC from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:02,429 - INFO - Saved RAW data for DBC to C:\Users\james\Projects\backtrader\data\DBC_raw.csv (4802 rows).
2025-03-08 08:32:02,430 - INFO - Loading data for GLD...
2025-03-08 08:32:02,431 - INFO - Downloading data for GLD from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:03,002 - INFO - Saved RAW data for GLD to C:\Users\james\Projects\backtrader\data\GLD_raw.csv (5107 rows).
2025-03-08 08:32:03,002 - INFO - Loading data for EDV...
2025-03-08 08:32:03,004 - INFO - Downloading data for EDV from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:03,608 - INFO - Saved RAW data for EDV to C:\Users\james\Projects\backtrader\data\EDV_raw.csv (4305 rows).
2025-03-08 08:32:03,608 - INFO - Loading data for LTPZ...
2025-03-08 08:32:03,610 - INFO - Downloading data for LTPZ from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:04,191 - INFO - Saved RAW data for LTPZ to C:\Users\james\Projects\backtrader\data\LTPZ_raw.csv (3899 rows).
2025-03-08 08:32:04,193 - INFO - Loading data for LOD...
2025-03-08 08:32:04,194 - INFO - Downloading data for LOD from 2000-01-01 to 2025-3-31.
2025-03-08 08:32:04,463 - WARNING - Attempt 1/3 failed for LOD: 'timestamp'
2025-03-08 08:32:04,499 - WARNING - Traceback (most recent call last):
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 174, in download_and_preprocess
    df = fdr.DataReader(ticker, start_date, end_date)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\data.py", line 92, in DataReader
    return YahooDailyReader(codes, start, end).read()
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 61, in read
    return _yahoo_data_reader(self.symbol, self.exchange, self.start, self.end)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 41, in _yahoo_data_reader
    index = pd.to_datetime(jo['chart']['result'][0]['timestamp'], unit='s').normalize()
KeyError: 'timestamp'

2025-03-08 08:32:04,500 - INFO - Retry 1/3 for LOD after 2s.
2025-03-08 08:32:06,716 - WARNING - Attempt 2/3 failed for LOD: 'timestamp'
2025-03-08 08:32:06,718 - WARNING - Traceback (most recent call last):
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 174, in download_and_preprocess
    df = fdr.DataReader(ticker, start_date, end_date)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\data.py", line 92, in DataReader
    return YahooDailyReader(codes, start, end).read()
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 61, in read
    return _yahoo_data_reader(self.symbol, self.exchange, self.start, self.end)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 41, in _yahoo_data_reader
    index = pd.to_datetime(jo['chart']['result'][0]['timestamp'], unit='s').normalize()
KeyError: 'timestamp'

2025-03-08 08:32:06,719 - INFO - Retry 2/3 for LOD after 4s.
2025-03-08 08:32:11,046 - WARNING - Attempt 3/3 failed for LOD: 'timestamp'
2025-03-08 08:32:11,047 - WARNING - Traceback (most recent call last):
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 174, in download_and_preprocess
    df = fdr.DataReader(ticker, start_date, end_date)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\data.py", line 92, in DataReader
    return YahooDailyReader(codes, start, end).read()
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 61, in read
    return _yahoo_data_reader(self.symbol, self.exchange, self.start, self.end)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 41, in _yahoo_data_reader
    index = pd.to_datetime(jo['chart']['result'][0]['timestamp'], unit='s').normalize()
KeyError: 'timestamp'

2025-03-08 08:32:11,048 - ERROR - Max retries exceeded for LOD.
2025-03-08 08:32:11,048 - ERROR - Error loading data: Cannot retrieve data for LOD: 'timestamp'
2025-03-08 08:32:11,063 - ERROR - Traceback (most recent call last):
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 174, in download_and_preprocess
    df = fdr.DataReader(ticker, start_date, end_date)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\data.py", line 92, in DataReader
    return YahooDailyReader(codes, start, end).read()
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 61, in read
    return _yahoo_data_reader(self.symbol, self.exchange, self.start, self.end)
  File "C:\Users\james\anaconda3\envs\dnn\lib\site-packages\FinanceDataReader\yahoo\data.py", line 41, in _yahoo_data_reader
    index = pd.to_datetime(jo['chart']['result'][0]['timestamp'], unit='s').normalize()
KeyError: 'timestamp'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\james\Projects\backtrader\backtest.py", line 61, in run_backtest
    data_feeds = prepare_backtrader_data(
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 304, in prepare_backtrader_data
    df = download_and_preprocess(
  File "C:\Users\james\Projects\backtrader\data_utils.py", line 222, in download_and_preprocess
    raise ConnectionError(f"Cannot retrieve data for {ticker}: {e}")
ConnectionError: Cannot retrieve data for LOD: 'timestamp'

